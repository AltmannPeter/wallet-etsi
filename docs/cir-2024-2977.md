# ZKP requirements in CIR 2024/2977

Based on [CIR 2024/2977](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202402977), there are several specific privacy requirements that directly impact the need for and implementation of privacy techniques, possibly including ZKP.

Articles 5(7) and 5(8) establish specific technical requirements for the management of person identification data:

> Where providers of person identification data revoke person identification data issued to wallet units, they shall make publicly available the validity status of person identification data they issue, in a privacy preserving manner, and indicate the location of that information in the person identification data. - Article 5(7)

> Providers of person identification data shall enable privacy preserving techniques which ensure unlinkability where the electronic attestations of attributes do not require the identification of the user. - Article 5(8)

Both articles mandate privacy-preserving behaviour without defining what these terms mean. It is not clear where "unlinkability" falls between basic pseudonymity or full transaction unlinkability. Where full unlinkability is the goal, ZKP is the established cryptographic standard to achieve it.

Recital (5) establishes the regulatory boundary condition for unlinkability:

> To ensure data protection by design and by default, the wallets should be provided with several privacy enhancing features to prevent providers of electronic identification means and electronic attestation of attributes from combining personal data obtained when providing other services with the personal data processed to provide the services falling within the scope of Regulation (EU) No 910/2014. - Recital (5)

Recital (5) leaves the specific privacy technique open, requiring only that personal data cannot be combined across contexts. This means no observable element must allow correlation between two distinct presentations of the same credential. This property can be satisfied using batch issuance of single-show credentials or ZKP.

Recital (6) defines the functional scope of the wallet, with three of its required capabilities carrying direct implications for selective disclosure:

> certain common functionalities should be available in all wallets, including the ability to securely request, obtain, **select, combine,** store, delete, share, and **present,** under the sole control of the wallet user, person identification data and electronic attestations of attributes. - Recital (6) [emphasis added].

The ability to "select", "combine", and "present" specific data points implies selective disclosure, possibly across multiple credentials. Salted attribute digests satisfy the basic case of disclosing a chosen attribute. ZKP satisfies the full range of capabilities (predicate proofs and linking proofs).

Article 3(5) sets a further requirement on user-controlled key binding:

> Providers of person identification data shall ensure that person identification data that they issue is cryptographically bound to the wallet unit to which it is issued. - Article 3 (5)

Cryptographic binding is typically demonstrated through a proof of possession (PoP) value embedded in the PID. If this value is static or reused across presentations, it becomes a correlation handle. Salted attribute digest approaches address this by requiring single-show attestations, while ZKP enables unlinkable PoP by design.
