# ZKP requirements in CIR 2024/2979

## Legal basis for ZKP integration

Based on [CIR 2024/2979]([https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202402977](https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202402979)), there are several specific privacy requirements that directly impact the need for and implementation of privacy techniques, possibly including ZKP.

Recital (8) establishes the regulatory basis for privacy-by-design, with direct implications for cross-relying-party unlinkability:

> To ensure data protection by design and by default, the wallets should be provided with available state-of-the-art privacy enhancing techniques. These features should provide the possibility that wallets can be used without the wallet user being trackable across different wallet-relying parties, if applicable in the usage scenario. For instance, wallet providers should consider state-of-the-art privacy mitigating measures in relation to wallet unit attestations, such as using ephemeral wallet unit attestations or batch issuance. In addition, embedded disclosure policies should warn the wallet users against inappropriate or illegal disclosure of attributes from electronic attestations of attributes. - Recital (8)

The recital mandates state-of-the-art privacy techniques and explicitly names cross-relying-party unlinkability as a goal. Batch issuance of single-show attestations satisfies this through issuing multiple static attestations for later single-show use. Ephemeral attestations cannot be pre-computed and stored as they are freshly generated for each session; a property that is satisfied by techniques relying on ZKP. Note that the recital frames these techniques as a recommendation for Providers in relation to the WUA, rather than a hard requirement.

Recital (9) establishes privacy requirements specifically for wallet unit attestations, including validity status checks and revocation mechanisms:

> Wallet unit attestations should make it possible for wallet-relying parties which request attributes from wallet units, to verify the validity status of the wallet unit that they are communicating with, as wallet unit attestations are to be revoked when a wallet unit is no longer considered valid. The information regarding the validity status of the wallet units should be made available in an interoperable manner, to ensure that it can be used by all wallet-relying parties. Moreover, for cases where wallet users lost their wallet units or no longer have control over it, wallet providers should enable wallet users to request the revocation of their wallet unit. To ensure the privacy and unlinkability, Member States should employ privacy preserving techniques also for the wallet unit attestation. This may include the usage of multiple wallet unit attestations for different purposes, disclosing only the minimally relevant information about the wallet necessary for a transaction, or to limit the lifetime of the wallet unit attestation as an alternative to the use of revocation identifiers.

The recital requires validity status checks to be private and unlinkable. It offers various techniques that reduce linkability through partitioning or minimization, but at the cost of operationally costly and complex issuance. Alternatively, ZKP-based revocation schemes would enable validity status checks without exposing revocation identifiers and without requiring per-session re-issuance. Given real-world deployment limitations (e.g., HSM scalability concerns), ZKP-based solutions may be necessary to meet the requirements in Recital (9).

## Derived ZKP requirements from the legal text

Below is a table deriving ZKP requirements from the above discussed sources.
